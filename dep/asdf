FROM alpine:3.7 as build

ENV ZOLA_ENDPOINT https://github.com/getzola/zola/releases/download/
ENV ZOLA_VERSION v0.11.0
ENV ZOLA_BINARY zola-${ZOLA_VERSION}-x86_64-unknown-linux-gnu.tar.gz


# Install Hugo
RUN set -x && \
  apk add --update wget ca-certificates && \
  wget ${ZOLA_ENDPOINT}/${ZOLA_VERSION}/${ZOLA_BINARY} && \
  tar xzf ${ZOLA_BINARY} && \
  rm -f ${ZOLA_BINARY} && \
  mv zola /usr/bin && \
  apk del wget ca-certificates && \
  rm /var/cache/apk/*

COPY ./homepage /homepage
WORKDIR /homepage

# Build public dir
#RUN /usr/bin/zola build

#FROM nginx:alpine

#COPY nginx/cert.pem /etc/ssl/certs/cert.pem
#COPY nginx/key.pem /etc/ssl/private/key.pem

#COPY --from=build /homepage/public /srv/public
#
#COPY nginx/default.conf /etc/nginx/conf.d/default.conf
#
#EXPOSE 80 443
